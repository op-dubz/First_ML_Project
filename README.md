# [Emotion Classification of Synthetic Images with a Convolutional Neural Network](https://www.curieuxacademicjournal.com/_files/ugd/99711c_d2bee29194e84ec083b99fbe017419b4.pdf)

This repository contains the code and dataset setup for a convolutional neural network (CNN) trained to classify human emotions in images generated by the Midjourney stable diffusion model. The project explores the efficacy of training a discriminative model on synthetic data and evaluates performance on both synthetic and real-world images.

## Project Overview

I developed (with help from my mentor Anna Bair) a small CNN model to classify synthetic images into three emotion categories: `happy`, `sad`, and `angry`. All synthetic data was generated using **Midjourney** via text prompts, curated for realism and clarity. We then tested the CNN's generalization by evaluating it on both synthetic and real data.

### Goals
- Evaluate performance of CNNs trained on synthetic images.
- Analyze hyperparameter effects on model performance.
- Test transferability of synthetic-trained models to real image classification. 

## Dataset

- **Source**: Images generated using Midjourney with prompt engineering.
- **Size**: 301 total images (212 training, 44 validation, 45 test).
- **Classes**: `happy`, `sad`, `angry`.

### Sample Prompts
A male who is sad. The picture is realistic and simple --style raw --stylize 300
A person who is happy. The picture is realistic and simple --stylize 200

## CNN Architecture

Our base CNN consists of:
- Two convolutional "blocks", each with:
  - `Conv2D â†’ ReLU â†’ Conv2D â†’ ReLU â†’ MaxPool2D`
- Input and output layers with 3 channels.
- Kernel size: 10 (Conv), 2 (Pooling)
- Stride: 1, Padding: 1
- Optimizer: SGD
- Loss: CrossEntropyLoss
- Epochs: 40
- Batch size: 20

### Data Augmentation & Preprocessing
- `RandomResizedCrop((224, 224), antialias=True)`
- `RandomHorizontalFlip(p=0.5)`
- `Resize((224, 224))`
- `ToTensor()`

## ðŸ“Š Results

- **Synthetic Test Accuracy**: ~62.22%
- **Real Test Accuracy (model trained only on synthetic)**: ~46.82%
- Best Learning Rate: `3e-4`
- Optimal number of channels: `30`
- Best number of blocks: `2`

## Hyperparameter Tuning

I explored:
- Learning rates
- Kernel sizes
- Number of convolutional blocks
- Number of channels
- Depth of layers in each block

Graphs and detailed results are included in the research paper.

## Real-World Evaluation

I evaluated model performance on a real dataset consisting of 51 images (17 per emotion) gathered from online image searches. The purpose was to understand the limits of generalization when only synthetic training data is used.

## Requirements

- Python 3.8+
- PyTorch
- torchvision
- PIL
